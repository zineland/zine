{% extends "base.jinja" -%}
{% import "_macros.jinja" as macros -%}
{% block content -%}
    <div class="px-4 pb-10 md:px-8 md:pb-14 mx-4 my-6 bg-white shadow-xl shadow-slate-700/10 ring-1 ring-gray-900/5">
        <div class="sticky z-10 py-4 top-32 lg:top-36 xl:top-44 2xl:top-56 bg-white border-dashed border-b border-slate-300">
            <div class="mx-2 flex justify-between items-center">
                <div>
                    <a class="before:block before:absolute before:-inset-1 before:-skew-x-6 before:bg-primary relative inline-block transition sm:hover:scale-110 duration-500"
                       href="/{{ issue.slug }}">
                        <div class="relative text-main px-4">{{ issue.title }}</div>
                    </a>
                    <span class="ml-2 text-gray-700">/ {{ fluent(key = "article-number", number = number) }}</span>
                </div>
                <div>
                {% set translation_length = i18n | length -%}
                {% set common_style = "py-1 my-1 rounded hover:bg-gray-100" -%}
                <div class="flex items-center">
                    {% if translation_length > 1 -%}
                    <div id="i18n-menu" class="ml-2 p-2 cursor-pointer rounded hover:bg-gray-200">
                        <svg height="16" viewBox="0 0 1024 1024" width="16" xmlns="http://www.w3.org/2000/svg"><path d="m531 703.2c.8-1.2 1.8-2.6 2.4-3.8.8-1.4 1.4-2.6 2-4s1.2-2.8 1.6-4.2 1-2.8 1.2-4.4c.4-1.4.6-3 .8-4.4.2-1.6.4-3 .4-4.6v-4.6c0-1.6-.2-3-.4-4.6-.2-1.4-.6-3-1-4.4s-.8-3-1.4-4.4l-1.8-4.2c-.6-1.4-1.4-2.6-2.2-4-.8-1.2-1.6-2.6-2.6-3.8s-1.8-2.4-3-3.4c-1-1.2-2.2-2.2-3.2-3.2-1.2-1-2.4-2-3.6-2.8-.4-.4-31.6-23.4-77-73.2 83.6-113.2 131-242 150.4-302.6h68c1.6 0 3 0 4.6-.2s3-.4 4.6-.6c1.4-.2 3-.6 4.4-1.2 1.4-.4 2.8-1 4.2-1.6s2.8-1.2 4.2-2 2.6-1.4 4-2.4c1.2-.8 2.4-1.8 3.6-2.8s2.2-2 3.4-3c1-1 2-2.2 3-3.4s1.8-2.4 2.8-3.6c.8-1.2 1.6-2.6 2.4-4s1.4-2.8 2-4.2 1-2.8 1.6-4.2c.4-1.4.8-3 1.2-4.4s.6-3 .6-4.6c.2-1.6.2-3 .2-4.6s0-3-.2-4.6-.4-3-.6-4.6-.6-3-1.2-4.4c-.4-1.4-1-2.8-1.6-4.2s-1.2-2.8-2-4.2-1.4-2.6-2.4-4c-.8-1.2-1.8-2.4-2.8-3.6s-2-2.2-3-3.4c-1-1-2.2-2-3.4-3s-2.4-1.8-3.6-2.8c-1.2-.8-2.6-1.6-4-2.4s-2.8-1.4-4.2-2-2.8-1-4.2-1.6c-1.4-.4-3-.8-4.4-1.2-1.4-.2-3-.6-4.6-.6-1.6-.2-3-.2-4.6-.2h-244.2v-41.4c0-1.6 0-3-.2-4.6s-.4-3-.6-4.6c-.2-1.4-.6-3-1.2-4.4-.4-1.4-1-2.8-1.6-4.2s-1.2-2.8-2-4.2-1.4-2.6-2.4-4c-.8-1.2-1.8-2.4-2.8-3.6s-2-2.2-3-3.4c-1-1-2.2-2-3.4-3s-2.4-1.8-3.6-2.8c-1.2-.8-2.6-1.6-4-2.4s-2.8-1.4-4.2-2-2.8-1-4.2-1.6c-1.4-.4-3-.8-4.4-1.2-1.4-.2-3-.6-4.6-.6-1.6-.2-3-.2-4.6-.2s-3 0-4.6.2-3 .4-4.6.6c-1.4.2-3 .6-4.4 1.2-1.4.4-2.8 1-4.2 1.6s-2.8 1.2-4.2 2-2.6 1.4-4 2.4c-1.2.8-2.4 1.8-3.6 2.8s-2.2 2-3.4 3-2 2.2-3 3.4-1.8 2.4-2.8 3.6c-.8 1.2-1.6 2.6-2.4 4s-1.4 2.8-2 4.2-1 2.8-1.6 4.2c-.4 1.4-.8 3-1.2 4.4s-.6 3-.6 4.6c-.2 1.6-.2 3-.2 4.6v42.2h-243.8c-1.6 0-3 0-4.6.2s-3 .4-4.6.6c-1.4.2-3 .6-4.4 1.2-1.4.4-2.8 1-4.2 1.6s-2.8 1.2-4.2 2-2.6 1.4-4 2.4c-1.2.8-2.4 1.8-3.6 2.8s-2.2 2-3.4 3c-1 1-2 2.2-3 3.4s-1.8 2.4-2.8 3.6c-.8 1.2-1.6 2.6-2.4 4s-1.4 2.8-2 4.2-1 2.8-1.6 4.2c-.4 1.4-.8 3-1.2 4.4-.2 1.4-.6 3-.6 4.6-.2 1.6-.2 3-.2 4.6s0 3 .2 4.6.4 3 .6 4.6c.2 1.4.6 3 1.2 4.4.4 1.4 1 2.8 1.6 4.2s1.2 2.8 2 4.2 1.4 2.6 2.4 4c.8 1.2 1.8 2.4 2.8 3.6s2 2.2 3 3.4c1 1 2.2 2 3.4 3s2.4 1.8 3.6 2.8 2.6 1.6 4 2.4 2.8 1.4 4.2 2 2.8 1 4.2 1.6 3 .8 4.4 1.2c1.4.2 3 .6 4.6.6 1.6.2 3 .2 4.6.2h416c-20 56.8-57 146.6-113.4 228.6-66.2-88-90.8-144.8-91-145.2-.6-1.4-1.2-2.8-2-4-.8-1.4-1.6-2.6-2.4-3.8s-1.8-2.4-2.8-3.6-2-2.2-3-3.4c-1-1-2.2-2-3.4-3s-2.4-1.8-3.6-2.6-2.6-1.6-4-2.2-2.8-1.4-4.2-1.8c-1.4-.6-2.8-1-4.2-1.4s-3-.8-4.4-1-3-.4-4.4-.6c-1.6-.2-3-.2-4.6-.2s-3 0-4.6.2-3 .4-4.4.6c-1.4.4-3 .6-4.4 1.2s-2.8 1-4.2 1.6-2.8 1.2-4 2c-1.4.8-2.6 1.4-3.8 2.4-1.2.8-2.4 1.8-3.6 2.8s-2.2 2-3.4 3c-1 1-2 2.2-3 3.4s-1.8 2.4-2.6 3.6-1.6 2.6-2.4 3.8c-.8 1.4-1.4 2.6-2 4s-1 2.8-1.6 4.2c-.4 1.4-.8 3-1.2 4.4-.2 1.4-.6 3-.6 4.4-.2 1.6-.2 3-.2 4.6s0 3 .2 4.6.4 3 .6 4.4.6 3 1 4.4 1 2.8 1.4 4.2c1.2 3 30.6 72.2 111.6 177 2 2.6 3.8 5 5.8 7.4-82.8 93.6-164 151.6-198 170.4-1.4.8-2.6 1.6-3.8 2.4s-2.4 1.8-3.6 2.8-2.2 2-3.4 3c-1 1-2 2.2-3 3.4s-1.8 2.4-2.6 3.6-1.6 2.6-2.4 4-1.4 2.8-2 4.2-1 2.8-1.6 4.4-.8 3-1 4.4-.4 3-.6 4.6-.2 3-.2 4.6 0 3 .2 4.6.4 3 .8 4.6c.4 1.4.6 3 1.2 4.4.4 1.4 1 2.8 1.6 4.2s1.2 2.8 2 4.2 1.6 2.6 2.4 3.8 1.8 2.4 2.8 3.6 2 2.2 3 3.4c1 1 2.2 2 3.4 3s2.4 1.8 3.6 2.6 2.6 1.6 4 2.4 2.8 1.4 4.2 2 2.8 1 4.4 1.4c1.4.4 3 .8 4.4 1s3 .4 4.6.6 3 .2 4.6.2 3-.2 4.6-.2c1.6-.2 3-.4 4.6-.8 1.4-.4 3-.6 4.4-1.2 1.4-.4 2.8-1 4.2-1.6s2.8-1.2 4.2-2c4.6-2.4 102.6-56.8 214.4-180.6 47.6 50.8 80.2 74.8 82.2 76.2 1.2.8 2.6 1.8 3.8 2.4 1.4.8 2.6 1.4 4 2.2l4.2 1.8c1.4.4 2.8 1 4.4 1.2 1.4.4 3 .6 4.4.8 1.6.2 3 .4 4.6.4h4.6c1.6 0 3-.2 4.6-.4s3-.6 4.4-1 3-.8 4.4-1.4l4.2-1.8c1.4-.6 2.8-1.4 4-2.2s2.6-1.6 3.8-2.6 2.4-1.8 3.4-3c1.2-1 2.2-2.2 3.2-3.2.4-2.6 1.2-3.8 2.2-5zm141.2 40.2 70-169.4 70 169.4zm302.8 151.2-189.8-459.8c-.8-2.2-1.8-4.2-3-6.2s-2.4-3.8-4-5.6-3-3.4-4.8-5c-1.6-1.6-3.4-3-5.4-4.2-1.8-1.2-3.8-2.4-6-3.4-2-1-4.2-1.8-6.4-2.4s-4.4-1.2-6.6-1.4c-2.2-.4-4.6-.6-6.8-.6s-4.6.2-6.8.6-4.4.8-6.6 1.4-4.4 1.4-6.4 2.4-4 2.2-6 3.4c-1.8 1.2-3.6 2.6-5.4 4.2-1.6 1.6-3.2 3.2-4.8 5-1.4 1.8-2.8 3.6-4 5.6s-2.2 4-3 6.2l-189.8 459.8c-.6 1.4-1.2 2.8-1.6 4.2s-.8 3-1.2 4.4-.6 3-.6 4.6c-.2 1.6-.2 3-.2 4.6s0 3 .2 4.6.4 3 .6 4.6c.2 1.4.6 3 1.2 4.4.4 1.4 1 2.8 1.6 4.4s1.2 2.8 2 4.2 1.4 2.6 2.4 4c.8 1.2 1.8 2.4 2.8 3.6s2 2.4 3 3.4 2.2 2.2 3.4 3c1.2 1 2.4 1.8 3.6 2.8 1.2.8 2.6 1.6 4 2.4s2.8 1.4 4.2 2 2.8 1 4.4 1.6c1.4.4 3 .8 4.4 1.2 1.4.2 3 .6 4.6.6 1.6.2 3 .2 4.6.2s3 0 4.6-.2 3-.4 4.6-.6c1.4-.4 3-.6 4.4-1.2 1.4-.4 2.8-1 4.2-1.6s2.8-1.2 4.2-2 2.6-1.6 4-2.4 2.4-1.8 3.6-2.8 2.2-2 3.4-3c1-1 2-2.2 3-3.4s1.8-2.4 2.8-3.6c.8-1.2 1.6-2.6 2.4-4s1.4-2.8 2-4.2l38.6-93.6h216.6l38.6 93.6c.8 2.2 1.8 4.2 3 6.2s2.4 3.8 4 5.6c1.4 1.8 3 3.4 4.8 5 1.6 1.6 3.4 3 5.4 4.2 1.8 1.2 3.8 2.4 6 3.4 2 1 4.2 1.8 6.4 2.4s4.4 1.2 6.6 1.4c2.2.4 4.6.6 6.8.6h2.8c1 0 1.8-.2 2.8-.2 1-.2 1.8-.2 2.8-.4s1.8-.4 2.8-.6 1.8-.4 2.8-.8c1-.2 1.8-.6 2.6-1s1.8-.8 2.6-1.2 1.8-.8 2.6-1.2 1.6-1 2.4-1.4 1.6-1 2.4-1.6 1.6-1.2 2.2-1.8c.8-.6 1.4-1.2 2.2-1.8s1.4-1.2 2-2l2-2c.6-.8 1.2-1.4 1.8-2.2s1.2-1.6 1.6-2.4c.6-.8 1-1.6 1.6-2.4.4-.8 1-1.6 1.4-2.6.4-.8.8-1.8 1.2-2.6s.8-1.8 1-2.6c.4-.8.6-1.8.8-2.8s.6-1.8.8-2.8.4-1.8.6-2.8.2-1.8.4-2.8c0-1 .2-1.8.2-2.8v-2.8c0-1 0-1.8-.2-2.8 0-1-.2-1.8-.4-2.8s-.4-1.8-.6-2.8-.4-1.8-.6-2.8-.6-1.8-.8-2.8c-1-1.4-1.2-2.2-1.6-3z"/></svg>
                    </div>
                    {% endif -%}
                    <div id="toc-menu" class="ml-2 p-2 cursor-pointer rounded hover:bg-gray-200">
                        <svg aria-hidden="true"
                             height="16"
                             viewBox="0 0 16 16"
                             version="1.1"
                             width="16"
                             data-view-component="true">
                            <path fill-rule="evenodd"
                                  d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z">
                            </path>
                        </svg>
                    </div>
                    </div>
                    {% if translation_length > 1 -%}
                    <div id="i18n-list" 
                         class="absolute hidden right-5 px-2 flex flex-col py-2 my-4 border bg-white rounded z-[99999] shadow-xl">
                        {% for translation in i18n -%}
                            {% if translation.path -%}
                            <a class="{{ common_style }} px-8" href="{{ translation.path }}">
                            {% else -%}
                            <a class="{{ common_style }} px-8" href="/{{ issue.slug }}/{{ translation.slug }}">
                            {% endif -%}
                            {{ translation.name }}
                            </a>
                        {% endfor -%}
                    </div>
                    {% endif -%}
                    <div id="toc-list"
                         class="absolute hidden right-0 flex flex-col max-w-screen-sm max-h-96 w-60 py-2 my-4 border bg-white rounded z-[99999] shadow-xl">
                         <div class="px-2 overflow-y-auto">
                        {% for item in toc -%}
                            <a href="#{{ item.id }}">
                                {% if item.depth == 1 -%}
                                    {% set variant_style = "pl-2 text-gray-800 font-bold text-sm" -%}
                                {% elif item.depth == 2 -%}
                                    {% set variant_style = "pl-4 text-gray-700 text-sm" -%}
                                {% elif item.depth == 3 -%}
                                    {% set variant_style = "pl-6 text-gray-600 text-xs" -%}
                                {% endif -%}
                                {% if variant_style -%}
                                    <div class="{{ common_style }} {{ variant_style }}">{{ item.title }}</div>
                                {% endif -%}
                            </a>
                        {% endfor -%}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="pt-10">
            <div class="prose mx-auto">
                <h1 class="text-center">{{ article.title }}</h1>
                <div class="flex items-center justify-between text-gray-500">
                    <span>{{ article.pub_date }}</span>
                    {{ macros::author_link(author = article.author) }}
                </div>
            </div>
            <article class="prose mx-auto my-12">
                {{ html | safe }}
            </article>
            {% if siblings.0 or siblings.1 -%}
                <div class="my-4 w-full border-dashed border-t border-slate-300"></div>
                <div class="flex flex-col md:flex-row">
                    {% for article in [siblings.0, siblings.1] -%}
                        {% if article -%}
                            <a class="inline my-1 py-2 px-4 font-bold text-slate-700 hover:underline"
                               href="/{{ issue.slug }}/{{ article.slug }}">
                                {% if loop.index0 == 0 -%}
                                    {{ fluent(key = "previous") }}
                                {% else -%}
                                    {{ fluent(key = "next") }}
                                {% endif -%}
                                {{ article.title }}
                            </a>
                        {% endif -%}
                    {% endfor -%}
                </div>
            {% endif -%}
        </div>
    </div>
    <div class="inline-link-card absolute hidden border rounded bg-white shadow-xl mx-2 w-96 transition ease-in-out sm:hover:scale-105 duration-500">
        <a class="inline-link-url">
            <div class="">
                <img class="inline-link-image w-full h-52 object-cover rounded-t">
                <div class="inline-link-title font-bold p-4 line-clamp-2"></div>
            </div>
        </a>
    </div>
    {% if theme.article_extend_template -%}
        {% include "article_extend_template.jinja" -%}
    {% endif -%}
{% endblock content -%}
